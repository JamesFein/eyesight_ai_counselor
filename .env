# ===========================================
# 应用基础配置
# ===========================================
# 应用名称，显示在日志和界面中
APP_NAME="RAG Chat Application"
# 应用版本号
APP_VERSION="1.0.0"
# 服务器监听地址，0.0.0.0表示监听所有网络接口
APP_HOST=0.0.0.0
# 服务器监听端口
APP_PORT=8000
# 是否启用调试模式，true时会显示详细错误信息
DEBUG=false
# 运行环境：development(开发)/production(生产)
ENVIRONMENT=production

# ===========================================
# API配置
# ===========================================
# API版本1的路径前缀，所有v1接口都以此开头
API_V1_PREFIX="/api/v1"

# ===========================================
# OpenAI API配置（兼容性保留）
# ===========================================

# ===========================================
# LLM配置（对话生成模型）
# ===========================================
# LLM API密钥，用于对话生成（可与嵌入模型使用不同的密钥）
LLM_API_KEY=sk-zbruJKss5bHXcDraW0mcHI5xcYhUJ4fi80kxV16IWly1F3Nn
# LLM API基础URL，支持OpenAI官方或代理地址
LLM_BASE_URL=https://api.openai-proxy.org/v1
# LLM模型名称：gpt-4o-mini(快速便宜) / gpt-4o(质量更高) / gpt-3.5-turbo(经济)
LLM_MODEL=gpt-4.1
# 生成温度：0.0(确定性强) - 2.0(创造性强)，影响回答的随机性和创造性
LLM_TEMPERATURE=0.1
# 最大生成token数，控制回答长度，过大会增加成本和延迟
LLM_MAX_TOKENS=20000
# Top-p采样参数：0.0-1.0，与temperature配合控制生成多样性
LLM_TOP_P=0.9

# ==================== 问题改写LLM配置 ====================
# 是否启用问题改写功能：true(启用) / false(禁用)
QUERY_REWRITE_ENABLED=true
# 问题改写LLM API密钥（用于将用户简短问题改写为包含上下文的完整问题）
QUERY_REWRITE_LLM_API_KEY=sk-zbruJKss5bHXcDraW0mcHI5xcYhUJ4fi80kxV16IWly1F3Nn
# 问题改写LLM API基础URL
QUERY_REWRITE_LLM_BASE_URL=https://api.openai-proxy.org/v1
# 问题改写LLM模型名称：gpt-4o(推荐,理解力强) / gpt-4o-mini(经济) / gpt-3.5-turbo(最便宜)
QUERY_REWRITE_LLM_MODEL=gpt-4.1
# 问题改写温度：建议0.0-0.3(确定性强,改写结果稳定)
QUERY_REWRITE_LLM_TEMPERATURE=0.1
# 问题改写最大token数：改写后的问题通常较短,200-500足够
QUERY_REWRITE_LLM_MAX_TOKENS=300

# ===========================================
# 嵌入模型配置
# ===========================================
# 嵌入模型API密钥，用于文档向量化（可与LLM使用相同密钥）
EMBEDDING_API_KEY=sk-hvyfufjdeylqtietsuzkkpcxjbazrewjfujgmpwlppefkuej
# 嵌入模型API基础URL
EMBEDDING_BASE_URL=https://api.siliconflow.cn/v1/
# 嵌入模型：text-embedding-3-small(性价比高) / text-embedding-3-large(质量更高)
EMBEDDING_MODEL=Qwen/Qwen3-Embedding-4B
# 嵌入向量维度，必须与Qdrant集合配置一致，影响检索精度和存储空间
EMBEDDING_DIMENSIONS=2560

# ===========================================
# 存储配置
# ===========================================
# 文档数据存储目录，相对于项目根目录
DATA_DIR=./data
# Qdrant向量数据库集合名称，用于存储文档向量
COLLECTION_NAME=ai_counselor_knowledge

# ===========================================
# Qdrant向量数据库配置
# ===========================================
# Qdrant服务器地址，本地部署使用localhost，远程部署填写实际IP
QDRANT_HOST=localhost
# Qdrant HTTP API端口，默认6333
QDRANT_PORT=6333
# Qdrant GRPC端口，默认6334，GRPC性能更好
QDRANT_GRPC_PORT=6334
# Qdrant API密钥，本地部署可为空，云服务需要填写
QDRANT_API_KEY=
# 是否优先使用GRPC协议，true时性能更好但需要额外端口
QDRANT_PREFER_GRPC=true
# 向量维度，必须与嵌入模型维度一致，影响存储空间和检索性能
QDRANT_VECTOR_SIZE=2560
# 距离度量方式：COSINE(余弦相似度，推荐) / DOT(点积) / EUCLIDEAN(欧几里得距离)
QDRANT_DISTANCE_METRIC=COSINE

# ===========================================
# RAG检索配置（核心调优参数）
# ===========================================
# 最大返回结果数：1-20，越多提供更多上下文但增加token消耗，建议3-8
RAG_MAX_RESULTS=5
# 相似度阈值：0.0-1.0，越高越严格，0.7适中，0.8较严格，0.6较宽松
SEMANTIC_SIMILARITY_THRESHOLD=0.5
# 检索模式：semantic_only(纯语义) / hybrid(混合检索)
RAG_RETRIEVAL_MODE=semantic_only
# 是否启用重排序：true时对检索结果重新排序，提高相关性但增加延迟
RAG_ENABLE_RERANKING=false
# 上下文最大token数：限制传给LLM的上下文长度，避免超出模型限制
RAG_CONTEXT_MAX_TOKENS=4000

# ===========================================
# 混合检索配置
# ===========================================
# BM25 检索参数
BM25_TOP_K=5                    # BM25 返回的最大结果数
BM25_THRESHOLD=2            # BM25 最小分数阈值 (>=0, 无上限, BM25分数范围0到无穷大，之后再慢慢调整)

# 语义向量检索参数
SEMANTIC_TOP_K=3                # 语义检索返回的最大结果数
SEMANTIC_THRESHOLD=0.2          # 语义检索最小相似度阈值 (0.0-1.0, 余弦相似度)

# ===========================================
# 文档分块配置（影响检索粒度）
# ===========================================
# 分块大小（字符数）：200-1000，越小粒度越细但可能丢失上下文，建议300-600
# CHUNK_SIZE=512
# 分块重叠（字符数）：通常为分块大小的10-20%，保持上下文连续性
# CHUNK_OVERLAP=106
# 是否使用句子分割：true时优先在句子边界分割，适合短文档
##CHUNK_USE_SENTENCE_SPLITTING=false
# 最小分块大小：小于此值的分块会被合并，避免过短的无意义片段
# CHUNK_MIN_SIZE=100
# 是否启用chonkie智能分块器：true时使用句子边界智能分割，推荐开启
CHUNK_ENABLE_CHONKIE=true
# 分块分隔符：按优先级尝试分割，中英文标点符号和换行符
# CHUNK_DELIMITERS=["。", "！", "？", ". ", "! ", "? ", "\n"]

