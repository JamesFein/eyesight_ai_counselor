## 同义词扩展的本质

想象你有一个朋友叫"张伟"，但大家都叫他"小张"、"阿伟"、"张三"。

 

现在你在图书馆找一本他写的书。如果你只搜"张伟"，可能找不到——因为书上写的是"小张著"。

 

**同义词扩展就是告诉搜索引擎："嘿，当用户说A的时候，也帮我找找B、C、D"。**



------

## 在你的系统里怎么工作？

### 第一步：用户问问题



```
用户："OK镜效果怎么样?"
```

### 第二步：系统翻译问题（查同义词表）

系统看到"OK镜"，查表发现：





```python
"OK镜" → ["角膜塑形镜", "夜戴镜", "塑形镜"]
```

### 第三步：扩展成多个查询

原来的1个问题变成4个平行问题：





```
1. "OK镜效果怎么样?"           ← 原始问题
2. "角膜塑形镜效果怎么样?"     ← 扩展1
3. "夜戴镜效果怎么样?"         ← 扩展2
4. "塑形镜效果怎么样?"         ← 扩展3
```

### 第四步：用这4个问题都去搜

BM25检索会分别去找：



- 包含"OK镜"的文档块
- 包含"角膜塑形镜"的文档块 ← **可能找到更多！**
- 包含"夜戴镜"的文档块
- 包含"塑形镜"的文档块

### 第五步：合并去重

把4次搜索的结果合并，去掉重复的，按相关度排序。



------

## 为什么需要这个？

因为**作者和用户可能说的不是同一种话**：



- 用户（家长）说："OK镜"
- 文档（专业）写："角膜塑形镜验配流程..."

如果只搜"OK镜"三个字，可能漏掉90%的相关内容！



------

## 代码层面怎么实现？



```python
# 用户问题
user_query = "OK镜效果怎么样?"

# 查表扩展
expanded_queries = ["OK镜效果怎么样?"]

if "OK镜" in user_query:
    synonyms = ["角膜塑形镜", "夜戴镜", "塑形镜"]
    for syn in synonyms:
        new_query = user_query.replace("OK镜", syn)
        expanded_queries.append(new_query)

# 现在有4个查询了
print(expanded_queries)
# ['OK镜效果怎么样?', 
#  '角膜塑形镜效果怎么样?', 
#  '夜戴镜效果怎么样?', 
#  '塑形镜效果怎么样?']

# 对每个查询都跑一遍BM25
all_results = []
for query in expanded_queries:
    results = bm25_search(query)  # 搜索
    all_results.extend(results)   # 收集结果

# 去重 + 排序
final_results = deduplicate_and_rank(all_results)
```

------

## 关键点

1. **不改文档**：你的9个文档一个字都不用改
2. **只改查询**：在搜索的时候动态扩展用户问题
3. **透明的**：用户不知道背后做了4次搜索，他只看到"找到了更多相关内容"

------

## 实际例子

**场景1：缩写问题**





```
用户："SE是什么意思?"
扩展 → "SE是什么意思?" + "等效球镜是什么意思?" + "等效球镜度是什么意思?"
结果：能找到解释SE的段落（可能文档里写的是"等效球镜"）
```

**场景2：俗称问题**





```
用户："给孩子配个防近视的眼镜"
扩展 → "防近视的眼镜" + "离焦框架眼镜" + "近视防控眼镜" + "功能性镜片"
结果：找到所有专业文档里的相关章节
```